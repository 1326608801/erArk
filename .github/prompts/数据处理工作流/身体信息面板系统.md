# 身体信息面板系统

## 概述

身体信息面板（`body_info_panel.py`）是游戏中用于展示角色身体各部位状态的UI系统，主要展示各身体部位的精液污染情况、初次记录、怀孕状态等信息。该系统与游戏的污浊系统（Dirty System）和初次记录系统（First Record System）紧密结合。

## 核心组件

### 1. CharacterBodyText 类

主面板类，负责渲染角色的身体信息显示。

#### 初始化参数
- `character_id`: 要显示的角色ID
- `width`: 面板宽度
- `column`: 每行状态的最大列数
- `center_status`: 是否居中显示状态文本（默认True）

#### 主要功能
绘制角色身体各部位的详细信息，包括：
- 总体精液接触情况
- 各部位的初次记录和当前状态
- 怀孕和生育信息
- 特殊收集品统计

### 2. 身体部位系统

#### 身体部位定义（BodyPart.csv）
游戏中定义了19个身体部位（0-18）：

| ID | 部位名称 | 说明 |
|----|---------|------|
| 0  | 头发 | 容积表：5-50-400 |
| 1  | 脸部 | 容积表：5-50 |
| 2  | 口腔 | 容积表：10-50-150 |
| 3  | 胸部 | 容积表：5-50-200 |
| 4  | 腋部 | 容积表：5-50 |
| 5  | 手部 | 容积表：5-50 |
| 6  | 小穴 | 容积表：5-50-100-200 |
| 7  | 子宫 | 容积表：5-50-150-500-1000-2000-3000 |
| 8  | 后穴 | 容积表：5-100-200-500-1000-2000-3000-6000 |
| 9  | 尿道 | 容积表：5-50-100-200-400-600 |
| 10 | 腿部 | 容积表：5-50-100 |
| 11 | 脚部 | 容积表：5-50 |
| 12 | 尾巴 | 容积表：10-100-500-1000 |
| 13 | 兽角 | 容积表：5-50 |
| 14 | 兽耳 | 容积表：5-50-200 |
| 15 | 胃部 | 容积表：5-100-500-1000-1500-2000-3000 |
| 16 | 胯部 | 容积表：5-50 |
| 17 | 腹部 | 容积表：5-50-100 |
| 18 | 背部 | 容积表：5-100-400 |

#### 容积系统
- **容积表**：定义各等级的精液容量阈值
- **正常流通表**：定义精液在部位间的正常流动
- **满溢流通表**：当部位满溢时的流动路径
- **额外流通表**：特殊情况下的流动

### 3. 污浊系统（DIRTY）

#### 数据结构（game_type.py）
```python
class DIRTY:
    body_semen: dict  # 身体精液情况
    # 格式：{部位ID: [部位名, 当前精液量, 当前精液等级, 总精液量]}
    
    cloth_semen: dict  # 服装精液情况
    semen_flow: list  # 精液流通情况
    absorbed_total_semen: int  # 累计吸收的精液总量
```

#### 污浊等级（dirty.csv）
每个部位有不同的污浊等级描述：
- 等级1：有一点精液
- 等级2：能看出精液附着/精液滋润
- 等级3：大量精液
- 等级4：精液覆盖/满是精液

### 4. 初次记录系统（FIRST_RECORD）

#### 数据结构
```python
class FIRST_RECORD:
    # 初吻记录
    first_kiss_id: int  # 初吻对象ID（-1为无）
    first_kiss_time: datetime  # 初吻时间
    first_kiss_place: List[str]  # 初吻地点
    first_kiss_body_part: int  # 初吻部位（1为阴茎）
    
    # 处女记录
    first_sex_id: int  # 处女对象ID（-1为无）
    first_sex_time: datetime  # 处女时间
    first_sex_place: List[str]  # 处女地点
    first_sex_posture: str  # 处女姿势
    
    # A处女记录
    first_a_sex_id: int  # A处女对象ID
    first_a_sex_time: datetime  # A处女时间
    first_a_sex_place: List[str]  # A处女地点
    first_a_sex_posture: str  # A处女姿势
```

## 显示内容详解

### 1. 总信息区域
- 显示角色全身被射上的精液总量
- 统计所有部位的累计精液量

### 2. 口部信息
- **初吻情况**：保有初吻 / 初吻记录（时间、地点、对象）
- **舌头技巧**：基于能力值71
- **精液摄入**：口腔和食道的精液总量

### 3. 胸部信息
- **胸部大小**：基于素质121-125显示描述文本
- **精液污染**：胸部被淋上的精液总量
- **乳汁收集**：玩家收集的该角色乳汁总量

### 4. 膣部信息
- **处女情况**：保有处女 / 处女记录（时间、地点、对象、姿势）
- **V感觉等级**：基于能力值4，分为0-4级
  - 0级：完全没有性经验
  - 1级：有过初次性经验
  - 2级：性生活比较丰富
  - 3级：阴道被充分开发
  - 4级：阴道开发到极致
- **精液射入量**：小穴被射入的精液总量

### 5. 肛部信息
- **后庭处女情况**：类似膣部
- **A感觉等级**：基于能力值5，分为0-4级
- **精液射入量**：后穴被射入的精液总量

### 6. 子宫信息
- **W感觉等级**：基于能力值7，分为0-4级
- **精液射入量**：子宫被射入的精液总量
- **怀孕状态**：
  - 受精天数（素质20）
  - 妊娠状态（素质21）
  - 临盆状态（素质22）
  - 产后状态（素质23）
  - 育儿状态（素质24）
- **生育记录**：生下的孩子数量和名字

### 7. 尿道信息
- **精液射入量**：尿道被射入的精液总量
- **圣水收集**：玩家收集的该角色圣水总量

### 8. 其他信息
- **精液吸收**：肠胃累计吸收的精液总量

## 相关系统接口

### 1. 能力值系统
- 能力值4：V感觉
- 能力值5：A感觉
- 能力值7：W感觉
- 能力值71：口技

### 2. 素质系统
- 素质0：处女
- 素质1：A处女
- 素质4：保有初吻
- 素质20-24：怀孕相关状态
- 素质121-125：胸部大小

### 3. UI文本系统
- `ability.csv`：定义各感觉等级的描述文本
- `dirty.csv`：定义污浊等级描述
- `dirty_full.csv`：完整污浊状态描述

### 4. 玩家收集系统
- `milk_total`：各角色的乳汁收集总量
- `urine_total`：各角色的圣水收集总量

## 数据流程

1. **数据读取**：从`cache.character_data[character_id]`获取角色数据
2. **状态判断**：根据素质、能力值、初次记录等判断显示内容
3. **文本生成**：根据状态生成对应的描述文本
4. **面板绘制**：使用`panel.CenterDrawTextListPanel`或`panel.LeftDrawTextListPanel`绘制

## 注意事项

1. 该面板仅对非玩家角色（character_id != 0）显示
2. 所有精液量单位为毫升（ml）
3. 初次记录使用-1表示无记录状态
4. 感觉等级计算公式：`(能力值 + 1) // 2`，范围限制在1-4之间
5. 身体部位的精液数据格式：`[部位名, 当前量, 等级, 总量]`